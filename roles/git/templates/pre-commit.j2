#!/usr/bin/env bash
{% if git_precommit_hook_type == 'auto' %}
# File generated by pre-commit: https://pre-commit.com
# ID: 138fd403232d2ddd5efb44317e38bf03

# start templated
{% if git_precommit_python_path %}
INSTALL_PYTHON='{{ git_precommit_python_path }}'
{% else %}
# Auto-detect pre-commit Python installation
INSTALL_PYTHON=''
for python_path in \
    "{{ user_home }}/.local/share/uv/tools/pre-commit/bin/python" \
    "{{ user_home }}/Library/Application Support/hatch/env/virtual/ezcli/k55xsevo/dev/bin/python3" \
    "{{ user_home }}/.local/pipx/venvs/pre-commit/bin/python" \
    "/opt/homebrew/bin/python3" \
    "/usr/local/bin/python3" \
    "/usr/bin/python3"; do
    if [ -x "$python_path" ] && "$python_path" -c "import pre_commit" 2>/dev/null; then
        INSTALL_PYTHON="$python_path"
        break
    fi
done
{% endif %}
ARGS=(hook-impl --config=.pre-commit-config.yaml --hook-type=pre-commit --skip-on-missing-config)
# end templated

HERE="$(cd "$(dirname "$0")" && pwd)"
ARGS+=(--hook-dir "$HERE" -- "$@")

if [ -n "$INSTALL_PYTHON" ] && [ -x "$INSTALL_PYTHON" ]; then
    exec "$INSTALL_PYTHON" -mpre_commit "${ARGS[@]}"
elif command -v pre-commit > /dev/null; then
    exec pre-commit "${ARGS[@]}"
else
    echo '`pre-commit` not found.  Did you forget to activate your virtualenv?' 1>&2
    exit 1
fi
{% else %}
# Warning-only hook: alerts when .pre-commit-config.yaml exists but pre-commit install not run
if [ -f .pre-commit-config.yaml ]; then
    echo 'pre-commit configuration detected, but `pre-commit install` was never run' 1>&2
    exit 1
fi
{% endif %}
